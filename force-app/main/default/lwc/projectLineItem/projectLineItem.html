<template>
    <div if:true={projectLineItem}>  

            <div if:true={projectLineItem.Role__c}>
                
                    <h1 class="slds-p-horizontal_small" style="font-weight:bold; font-size: 1.2em;">{projectLineItem.Role__c} </h1>
                    <h2 class="slds-p-horizontal_small" style="font-weight:bold; font-size: 1em;">&nbsp;&nbsp;&nbsp;Estimated Hours: {projectLineItem.Estimated_Hours__c} - Assigned Hours: {projectLineItem.Assigned_Hours__c} </h2>
                    <h2 class="slds-p-horizontal_small" style="font-weight:bold; font-size: 1em;">&nbsp;&nbsp;&nbsp;Estimated Amount: {projectLineItem.Estimated_Amount__c}     - Assigned Amount: {projectLineItem.Assigned_Amount__c}</h2>
                
                
                    <div >
                        <h2 class="slds-p-horizontal_small" style="font-weight:bold; font-size: 1em;">&nbsp;&nbsp;&nbsp;Filter Resources By Dates Availability</h2>
                        <div style="display:flex;flex-wrap: wrap;justify-content:space-around;">
                            <div>
                                <div class="header-column">
                                    <lightning-input type="date" name="startDateFilter"  value={startDateFilter} onchange={handleChangeFilter} placeholder="Start Date" min={projectStartDate} max={projectEndDate} ></lightning-input>
                                </div>
                            </div>      
                            <div>
                                <div class="header-column">
                                    <lightning-input type="date" name="endDateFilter"  value={endDateFilter} onchange={handleChangeFilter} placeholder="End Date" min={projectStartDate} max={projectEndDate} ></lightning-input>
                                </div>
                            </div>
                            <div>
                                <br>
                                <lightning-button variant="brand" label="Filter Resources" title="Primary action" onclick={handleFilter} class="slds-m-left_x-small"></lightning-button>
                            </div>
                            <div>
                                <br>
                                <lightning-button variant="brand-outline" label="Clear Filter" title="Primary action" onclick={handleCancelFilter} class="slds-m-left_x-small"></lightning-button>
                            </div>
                            <div>
                                <br>
                                <span if:false={showAvailability}><lightning-button variant="brand" label="Show Resources Availability" title="Primary action" onclick={handleResourcesAvailability} class="slds-m-left_x-small"></lightning-button></span>
                                <span if:true={showAvailability}><lightning-button variant="brand" label="Hide Resources Availability" title="Primary action" onclick={handleResourcesAvailability} class="slds-m-left_x-small"></lightning-button></span>
                            </div>
                        </div>
                        
                    </div>
                    <template if:true={showAvailability}>
                        <br>
                        <div style="display:flex;flex-wrap: wrap;justify-content:space-around;" class="slds-box slds-box_x-small">
                            <template for:each={availabilityByUserIdsMap} for:item="map">
                                <span key={map.key}>
                                    <lightning-card  title={map.key}>
                                                <template if:true={map.value} for:each={map.value} for:item="val">
                                                    <div key={val.startDate}>
                                                        <div> <b>Start Date:</b> {val.startDate} &nbsp; <b>End Date:</b> {val.endDate}</div>
                                                    </div>
                                                </template> 
                                                <template if:false={map.value}>
                                                    <div> Not available dates for this project </div>
                                                </template>
                                    </lightning-card>
                                </span>
                            </template>
                        </div>
                    </template>

                    <template if:true={resources}>
                        <div class="slds-p-around_small">
                            <lightning-datatable
                                    key-field="resourceId"
                                    data={resources}
                                    show-row-number-column
                                    row-number-offset={rowOffset}
                                    columns={columns}
                                    onsave={handleSave}
                                    hide-checkbox-column=true
                                    draft-values={draftValues}
                                    >
                            </lightning-datatable>
                            <br>
                        </div>
                    </template>
                
            </div>
    </div>
</template>